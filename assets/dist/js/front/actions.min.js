!function(t){"use strict";const{__:e,_x:a,_n:i,_nx:o}=wp.i18n;var n="gpls-arcw-quick-view-buy-now-for-woocommerce",r="gpls_arcw_quick_view_buy_now_for_woocommerce",s=null,p=null,d=null,c={},u={},l="no",g="closed",_=0;if(window[r+"_localize_vars"]){var w=window[r+"_localize_vars"];t(".gpls-arcw-loop-buy-now-quantity-input").prop("disabled",!0),t((function(){if(l=w.wc_add_to_cart_params.cart_redirect_after_add,"single"===w.woo_context){if(w.single_product_params){var e=w.single_product_params;e.add_to_cart_status&&"hidden"==e.add_to_cart_status&&t(".single_add_to_cart_button:not(.gpls-arcw-buy-now)").remove()}v()}t(document.body).on("click",".gpls-arcw-popup-back-btn",(function(t){t.preventDefault(),p.prevStep()})),t(document.body).on("click",".gpls-arcw-popup-close-btn",(function(t){t.preventDefault(),s.close()})),t(document.body).on("change",".gpls-arcw-quick-view-popup.grouped-product-popup .gpls-arcw-quantity-input",(function(e){var a=t(this).val();t(this).attr("value",a)})),t(document.body).on("adding_to_cart",(function(e,a,i){t(".gpls-arcw-buy-now").prop("disabled",!0)}))})),window.addEventListener("pageshow",(()=>{t(".gpls-arcw-loop-quantity-input").val(1)})),t(document.body).on("added_to_cart",(function(e,a,i,o,n){t(".single_add_to_cart_button").removeClass("loading"),t(".single_add_to_cart_button").prop("disabled",!1),t(".gpls-arcw-buy-now").prop("disabled",!1),o&&(o.addClass("added"),o.siblings("button").prop("disabled",!1)),t(".added_to_cart.wc-forward").prop("disabled",!1)})),t(document).on("click",".gpls-arcw-quick-view-btn",(function(e){e.preventDefault();var a=t(this),i=a.data("product_id"),o=a.data("product_type");a.removeClass("added").addClass("loading"),h(i,a,o)})),t(document.body).on("submit",".gpls-arcw-quick-view-popup:not(.variable-in-grouped-product-popup, .variable-in-grouped-product-single, .external-product-popup) form",(function(e,a){let i=t(this),o=i.find('input[name="gpls-arcw-regular-buy-now-request"]').length,n=i.find('.single_add_to_cart_button[type="submit"]');if(!(o&&a&&a["gpls-arcw-buy-now-regular-request"]||(e.preventDefault(),n.hasClass("disabled")))){var r=0,s=i.find("input.gpls-arcw-product-type").val();if(a=i.serializeArray(),"simple"===s&&(r=n.val(),a.push({name:"add-to-cart",value:r})),"external"===s)return i.find(".gpls-arcw-context").remove(),void i.find(".gpls-arcw-product-type").remove();f(a,n,"add-to-cart",!0)}})),t(document.body).on("click",".gpls-arcw-buy-now",(function(e){e.preventDefault();var a=t(this),i=t(this).closest("form.cart");let o=i.find('input[name="gpls-arcw-regular-buy-now-request"]').length;if(a.data("action"),!a.hasClass("disabled")){if(o){let t={"gpls-arcw-buy-now-regular-request":!0};i.append('<input type="hidden" name="gpls-arcw-regular-buy-now-request-buy-now" value="1" />');let e=i.find('[name="add-to-cart"]');if(e.is("button")){let t=document.createElement("input");t.type="hidden",t.name="add-to-cart",t.value=e.val(),i.append(t)}return i.trigger("submit",[t]),void(w?.screen_loader?.buy_now&&w.screen_loader.buy_now.status&&k("show"))}var n=t(this).parents(".gpls-arcw-quick-view-popup").length,r=t(this).data("product_id"),s=(i.find("input.gpls-arcw-product-type").val(),i.serializeArray());s.push({name:"add-to-cart",value:r}),f(s,a,"buy-now",n)}})),t(document).on("click",".gpls-arcw-variation-in-grouped-reset-variations",(function(e){e.preventDefault();var a=t(this).data("product_id");d.length&&d.find(".reset_variations").click(),t(this).closest(".woocommerce-grouped-product-list-item").remove(),delete c[a]})),t(document.body).on("click",".gpls-arcw-quick-view-popup.grouped-product-popup .gpls-arcw-variable-in-grouped-product-select-options",(function(e){e.preventDefault();var a=t(this),i=t(this).data("product_id"),o=(t(this).parents("#product-"+i),t(this).data("grouped_product_id"));_=o,a.addClass("loading"),h(i,a,"popup-variable-in-grouped",{otherQtys:b(".gpls-arcw-quick-view-popup .grouped_form .gpls-arcw-quantity-input:not(.gpls-arcw-variation-in-grouped-input)")})})),t(document.body).on("click",".gpls-arcw-quick-view-popup.variable-in-grouped-product-popup .variations_form .single_add_to_cart_button",(function(e){if(e.preventDefault(),!t(this).is(".disabled")){var a=t(this).closest(".variations_form"),i=(a.find('input[name="product_id"]').val(),a.find('input[name="variation_id"]').val()),o=a.find("input.gpls-arcw-quantity-input").val(),n=u[i];c[i]={attributes:n.attributes,chosenAttributes:{}},c[i].quantity=o,m(i,a),p.prevStep(!0)}})),w.woo_single_context&&"single-grouped"===w.woo_single_context&&(t(document.body).on("click",".gpls-arcw-variable-in-grouped-product-select-options",(function(e){e.preventDefault();var a=t(this),i=t(this).data("product_id"),o=(t(this).parents("#product-"+i),t(this).data("grouped_product_id"));_=o,a.addClass("loading"),h(i,a,"single-grouped")})),t(document).on("click",".gpls-arcw-quick-view-popup.variable-in-grouped-product-single .variations_form .single_add_to_cart_button",(function(e){if(e.preventDefault(),t(this).is(".disabled"))return;var a=t(this).closest(".variations_form"),i=(a.find('input[name="product_id"]').val(),a.find('input[name="variation_id"]').val()),o=a.find("input.gpls-arcw-quantity-input").val(),n=u[i];c[i]={attributes:n.attributes,chosenAttributes:{}},c[i].quantity=o,m(i,a);let r=b(".grouped_form .gpls-arcw-quantity-input:not(.gpls-arcw-variation-in-grouped-input)");t(".cart.grouped_form").find(".single_add_to_cart_button").addClass("loading"),y(r,"form.cart.grouped_form").then((e=>{t(".cart.grouped_form").find(".single_add_to_cart_button").removeClass("loading")})),s.close()}))),p={currentSwal:null,steps:{},latestStep:0,groupedID:0,stack:[],context:void 0,fireStep:function(e,a=!0,i=!1,o=null){if(!this.steps[e])return;let n={...this.steps[e]};if(delete n.additionalData,this.currentSwal=s=Swal.fire(n),i&&o&&this.steps[o]){let t=this.steps[o];Swal.showLoading(),this.toggleLoading("show"),y(t.additionalData.otherQtys,"form.cart.grouped_form",Swal).then((t=>{this.toggleLoading("hide")}))}if(jQuery.fn.wc_variation_form,(d=t(".gpls-arcw-quick-view-popup").find(".variations_form")).length&&(d.wc_variation_form(),d.on("show_variation",(function(t,e,a){a&&(u[e.variation_id]=e)}))),!a){var r=t(".gpls-arcw-quick-view-popup");r.find(".woocommerce-product-gallery__wrapper").unwrap(".flex-viewport"),r.find(".flex-control-nav").remove()}jQuery.fn.gpls_arcw_wc_product_gallery,t(".gpls-arcw-quick-view-popup .woocommerce-product-gallery").gpls_arcw_wc_product_gallery(w.wc_single_product_params),v(!0),t(document.body).trigger(w.prefix+"-quick-view-popup",[e])},get getGroupedID(){return this.groupedID},set setGroupedID(t){this.groupedID=t},addStep:function(e,a,i,o=!1,r={},s=!1,p="",d={}){var c=this,u={html:a+'<div class="gpls-arcw-popup-spinner" ><div class="spinner-wrapper"></div><img class="spinner" src="'+w.spinner+'"></div>',width:"auto",customClass:Object.assign({content:"site-main"},i),showConfirmButton:o,didClose:function(){window.history.replaceState(null,""," "),c.removeStep(e),g="closed",c.reset(),t(document).trigger(n+"-quick-view-popup-closed",this)},willOpen:function(e){!function(e,a,i){var o=t(e);if(a.add_to_cart_status&&"hidden"==a.add_to_cart_status){var n=o.find(".single_add_to_cart_button:not(.gpls-arcw-buy-now)");n.length&&n.remove()}if(t(e).find("#review_form_wrapper").remove(),t(".gpls-arcw-quick-view-popup .wc-tabs-wrapper, .gpls-arcw-quick-view-popup .woocommerce-tabs").trigger("gpls-arcw-quick-view-init"),g="opened","popup-variable-in-grouped"===i||"single-grouped"===i){let t=o.find(".variations_form .single_add_to_cart_button");t.length&&t.attr("type","button")}}(e,r,p),t(document).trigger(n+"-quick-view-popup-will-open",this)},didOpen:function(e){t(document).trigger(n+"-quick-view-popup-opened",this),t(document).trigger(n+"-quick-view-popup",this)},didRender:function(e){t(document).trigger(n+"-quick-view-popup-rendered",this)}},l='<button class="gpls-arcw-popup-close-btn" ><img src="'+w.icons.close+'" /></button>';"opened"===g&&(l='<button class="gpls-arcw-popup-back-btn" ><img src="'+w.icons.prev+'" /></button>'+l),u.title=l,u.additionalData=d,this.steps[e]=u,this.latestStep=this.getLatestStep();var _=t(".gpls-arcw-quick-view-popup").find("#swal2-content");if(_.length){var v=_.html();this.steps[this.latestStep].html=v}this.stack.push(e),s&&this.fireStep(e)},prevStep:function(t=null){let e=this.stack.pop();0===this.stack.length&&(this.currentSwal.close(),this.reset());var a=this.stack[this.stack.length-1];this.latestStep=a,this.fireStep(a,!1,t,e)},getLatestStep:function(){return this.stack.length?this.stack[this.stack.length-1]:null},removeStep:function(t){delete this.steps[t]},updateStep:function(t,e){this.steps[t]&&(this.steps[t].html=e)},reset:function(){this.currentSwal=null,this.steps={},this.latestStep=0,this.groupedID=0,this.stack=[],"popup-variable-in-grouped"!==this.context&&"single-grouped"!==this.context&&(c={})},toggleLoading:function(e="show"){let a=t(".gpls-arcw-quick-view-popup .gpls-arcw-popup-spinner");"show"===e?a.show():a.hide()}}}function v(e=!1){var a=".gpls-arcw-quick-view-popup",i=e?a+" .gpls-arcw-buy-now":".gpls-arcw-buy-now",o=e?a+" .single_add_to_cart_button":".single_add_to_cart_button",n=t(e?a+" .variations_form":".variations_form"),r=t(o).not(t(".gpls-arcw-buy-now")),s=t(i);r.length&&s.length&&(r.hasClass("disabled")&&s.addClass("disabled"),r.hasClass("wc-variation-is-unavailable")&&s.addClass("wc-variation-is-unavailable"),r.hasClass("wc-variation-selection-needed")&&s.addClass("wc-variation-selection-needed")),n.length&&s.length&&(n.on("hide_variation",(t=>{s.removeClass("wc-variation-is-unavailable").addClass("disabled wc-variation-selection-needed")})),n.on("show_variation",((t,e,a)=>{a?s.removeClass("disabled wc-variation-selection-needed wc-variation-is-unavailable"):s.addClass("disabled wc-variation-is-unavailable")})),n.find(s).length||s.on("click",(function(e){t(this).is(".disabled")&&(e.preventDefault(),t(this).is(".wc-variation-is-unavailable")?window.alert(w.wc_add_to_cart_variation_params.i18n_unavailable_text):t(this).is(".wc-variation-selection-needed")&&window.alert(w.wc_add_to_cart_variation_params.i18n_make_a_selection_text))})))}function f(e,a,i="add-to-cart",o=!1){a.removeClass("added").addClass("loading").prop("disabled",!0),t(".single_add_to_cart_button").not(a).removeClass("loading").prop("disabled",!0),"buy-now"===i&&(t(".single_add_to_cart_button").prop("disabled",!0),t(".added_to_cart.wc-forward").prop("disabled",!0)),e.push({name:"action",value:n+"-ajax_add_to_cart_action"}),e.push({name:n+"-action-type",value:i});var r={};t.each(e,(function(t,e){"add-to-cart"===e.name&&(e.name="gpls-plugins-general-prefix-ajax-add-to-cart"),r[e.name]=e.value})),function(t,e){var a=e?".gpls-arcw-quick-view-popup":".single-product";t.closest(a).find(".woocommerce-notices-wrapper:first").empty()}(a,o),t(document.body).trigger("adding_to_cart",[a,r]),"buy-now"===i&&w?.screen_loader?.buy_now&&w.screen_loader.buy_now.status&&k("show"),t.ajax({method:"POST",url:w.ajax_url,data:e,dataType:"json",success:function(e){if(e){if(e.notices&&function(e,a,i=!1,o=!1){var n=o?".gpls-arcw-quick-view-popup":"body",r=e.parents(n).find(".woocommerce-notices-wrapper:first");r.length&&(r.prepend(a),i&&(o?t(".gpls-arcw-quick-view-popup").animate({scrollTop:t("body").offset().top}):t("html, body").animate({scrollTop:r.offset().top})))}(a,e.notices,!0,o),void 0!==e.result&&!e.result)return k("hide"),t(".single_add_to_cart_button").prop("disabled",!1),void t(".single_add_to_cart_button").removeClass("loading");e.redirect_link?window.location=e.redirect_link:"yes"!==l?(k("hide"),t(document.body).trigger("added_to_cart",[e.fragments,e.cart_hash,a,r])):window.location=w.wc_add_to_cart_params.cart_url}else k("hide")},error:function(t){k("hide")},complete:function(){}})}function h(e,a,i=null,o={}){var r={action:n+"-quick_view_popup",product_id:e,woo_context:w.woo_context};if(void 0!==c[e]&&void 0!==c[e].chosenAttributes){var s=c[e].chosenAttributes;t.each(s,(function(t,e){r[t]=e.value})),r.quantity=c[e].quantity}null!=i&&(r[n+"_additional_action"]=i),w?.screen_loader?.quick_view&&w.screen_loader.quick_view.status&&k("show"),t.ajax({method:"POST",url:w.ajax_url,data:r,success:function(t){if(t.result&&1==t.result&&t.popup)return a.removeClass("loading"),void("grouped"===i?(p.setGroupedID=e,p.addStep(e,t.popup,{container:"gpls-arcw-quick-view-popup grouped-product-popup single-product"},!1,t.misc,!0,i,o)):"popup-variable-in-grouped"===i?p.addStep(e,t.popup,{container:"gpls-arcw-quick-view-popup variable-in-grouped-product-popup single-product"},!1,t.misc,!0,i,o):"single-grouped"===i?p.addStep(e,t.popup,{container:"gpls-arcw-quick-view-popup variable-in-grouped-product-single single-product"},!1,t.misc,!0,i,o):"external"===i?p.addStep(e,t.popup,{container:"gpls-arcw-quick-view-popup external-product-popup"},!1,t.misc,!0,i,o):p.addStep(e,t.popup,{container:"gpls-arcw-quick-view-popup single-product"},!1,t.misc,!0,"",o))},error:function(t){},complete:function(){a.removeClass("loading"),k("hide")}})}function m(e,a,i){var o=a.find(".variations").find('[name^="attribute_"]');t.each(o,(function(){var a=t(this),i=a.attr("name"),o=a.val(),n=function(t,e){var a=e.replace("attribute_","");return{variationLabel:t.parents(".variations_form").find('label[for="'+a+'"]').text(),variationValueLabel:(t.prop("type"),t.find(":selected").text())}}(a,i);c[e].chosenAttributes[i]={label:n.variationLabel,chosenLabel:n.variationValueLabel,value:o}}))}function b(e){let a=t(e);var i={};return t.each(a,(function(e){let a=t(this),o=parseInt(a.attr("name").replace(/[^\d]/g,""),10),n=parseInt(a.val(),10)||0;i[o]=n})),i}function y(e,a,i=null){return t.ajax({method:"POST",url:w.ajax_url,data:{otherQtys:e,action:w.updateGroupedCartFormAction,groupedProductID:_,groupedVariables:c},dataType:"json",success:function(e){e.status&&t(a).replaceWith(e.result)},error:function(t){},complete:function(){i&&i.hideLoading()}})}function k(e){if("show"===e&&w?.screen_loader?.random&&w.screen_loader.random.length){let e=w.screen_loader.random,a=e[Math.floor(Math.random()*e.length)],i=t(".gpls-arcw-screen-loader-"+a);i.length&&i.show()}else"show"===e?t(".gpls-arcw-screen-loader").show():t(".gpls-arcw-screen-loader").hide()}}(jQuery);